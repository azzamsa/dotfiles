#!/bin/bash

# Usage
#
# `up rust-analyzer 2022-09-12`
#

PACKAGE_NAME="$1"
PACKAGE_VERSION="$2"

if [ -z "$PACKAGE_NAME" ]; then
  echo "error: package is not specified"
  cat <<End-of-message

Supported packages:
- rust-analyzer
End-of-message
  exit 1
fi

update_rust_analyzer() {
  local version="$1"
  if [ -z "$version" ]; then
    echo "error: version is not specified"
    exit 1
  fi

  echo "ðŸš€ upgrading rust-analyzer"

  local link="https://github.com/rust-analyzer/rust-analyzer/releases/download/$version/rust-analyzer-x86_64-unknown-linux-gnu.gz"
  curl --silent --location "$link" --output /tmp/rust-analyzer.gz
  gunzip /tmp/rust-analyzer.gz
  chmod +x /tmp/rust-analyzer
  cp /tmp/rust-analyzer ~/.local/bin/

  echo "ðŸ– rust-analyzer upgraded"
  rust-analyzer --version

}

case $1 in
"rust-analyzer") update_rust_analyzer "$PACKAGE_VERSION" ;;
*) echo "unsupported package" ;;
esac
